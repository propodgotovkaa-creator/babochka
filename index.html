<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0" />
  <title>Genially: –†–µ–¥–∞–∫—Ç–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (Hidden Object)</title>
  <style>
    :root{
      --bg:#0b1020; --panel:rgba(20,24,40,.82); --line:rgba(255,255,255,.14);
      --txt:rgba(255,255,255,.92); --muted:rgba(255,255,255,.65);
      --btn:#2d6cdf; --btn2:#16a34a; --bad:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; background:radial-gradient(1200px 600px at 15% 10%, #1a2a6c 0%, transparent 60%), var(--bg); color:var(--txt);}
    .wrap{display:grid; grid-template-columns: 360px 1fr; gap:14px; height:100%; padding:14px;}
    .panel{
      background:var(--panel); border:1px solid var(--line); border-radius:14px;
      padding:14px; overflow:auto;
      backdrop-filter: blur(8px);
    }
    .panel h1{font-size:16px; margin:0 0 10px}
    .panel .hint{font-size:12px; color:var(--muted); line-height:1.35; margin:6px 0 10px}
    .row{margin:10px 0}
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px}
    input[type="text"], input[type="number"], select, textarea{
      width:100%; padding:10px 10px; border-radius:10px;
      border:1px solid var(--line); background:rgba(255,255,255,.06);
      color:var(--txt); outline:none;
    }
    input[type="range"]{width:100%}
    .two{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
    .btns{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    button{
      border:0; border-radius:10px; padding:10px 12px; cursor:pointer;
      color:white; font-weight:600;
    }
    .b1{background:var(--btn)}
    .b2{background:var(--btn2)}
    .b3{background:rgba(255,255,255,.12); border:1px solid var(--line); color:var(--txt); font-weight:600}
    .danger{background:var(--bad)}
    .small{font-size:12px; color:var(--muted)}
    .stage{
      position:relative;
      background:
        linear-gradient(0deg, rgba(255,255,255,.04), rgba(255,255,255,.04)),
        repeating-linear-gradient(45deg, rgba(255,255,255,.035) 0 12px, rgba(255,255,255,.02) 12px 24px);
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
      min-height:520px;
    }
    .topbar{
      position:absolute; left:10px; top:10px; right:10px;
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      z-index:5; pointer-events:none;
    }
    .badge{
      pointer-events:none;
      background:rgba(0,0,0,.45); border:1px solid rgba(255,255,255,.18);
      padding:6px 10px; border-radius:999px; font-size:12px; color:rgba(255,255,255,.9);
      backdrop-filter: blur(6px);
    }
    .previewRoot{position:absolute; inset:0}
    .target{
      position:absolute;
      will-change: transform, opacity;
      user-select:none;
      cursor:pointer;
      z-index:10;
    }
    .target img{display:block; width:100%; height:100%; object-fit:contain}

    @keyframes fxFadeIn{from{opacity:0} to{opacity:1}}
    @keyframes fxPopIn{0%{opacity:0; transform:scale(.7)} 100%{opacity:1; transform:scale(1)}}
    @keyframes fxSlideIn{0%{opacity:0; transform:translateY(-10px)} 100%{opacity:1; transform:translateY(0)}}
    @keyframes fxWiggle{0%{opacity:0; transform:scale(.9) rotate(-4deg)} 70%{opacity:1; transform:scale(1.02) rotate(2deg)} 100%{opacity:1; transform:scale(1) rotate(0deg)}}

    .fx-none{}
    .fx-fade{animation: fxFadeIn var(--dur,500ms) ease-out}
    .fx-pop{animation: fxPopIn var(--dur,500ms) cubic-bezier(.2,.8,.2,1)}
    .fx-slide{animation: fxSlideIn var(--dur,500ms) ease-out}
    .fx-wiggle{animation: fxWiggle var(--dur,650ms) cubic-bezier(.2,.8,.2,1)}

    .codeBox{height:260px; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px; line-height:1.35;}
    .ok{color:#86efac}
    .warn{color:#fbbf24}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="panel">
      <h1>–†–µ–¥–∞–∫—Ç–æ—Ä ¬´–ù–∞–π–¥–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞¬ª –¥–ª—è Genially</h1>
      <div class="hint">
        1) –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–∞–±–æ—á–∫–∞ –∏–∑ —Ç–≤–æ–µ–≥–æ GitHub.<br>
        2) –ú–æ–∂–µ—à—å –∑–∞–º–µ–Ω–∏—Ç—å URL –Ω–∞ –ª—é–±–æ–π PNG/WebP/SVG —Å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é.<br>
        3) –ù–∞–∂–º–∏ ¬´–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥¬ª ‚Üí –≤—Å—Ç–∞–≤—å –≤ Genially —á–µ—Ä–µ–∑ HTML/Embed.
      </div>

      <div class="row">
        <label>URL –∫–∞—Ä—Ç–∏–Ω–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</label>
        <input id="imgUrl" type="text" placeholder="https://.../babochka.png" />
        <div class="small" id="imgStatus"></div>
      </div>

      <div class="two">
        <div class="row">
          <label>–†–∞–∑–º–µ—Ä (px): <span id="sizeVal">46</span></label>
          <input id="size" type="range" min="18" max="160" value="46" />
        </div>
        <div class="row">
          <label>–†–∞—É–Ω–¥—ã (–Ω–∞—Ö–æ–¥–æ–∫)</label>
          <input id="rounds" type="number" min="1" max="50" value="7" />
        </div>
      </div>

      <div class="two">
        <div class="row">
          <label>–ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è</label>
          <select id="anim">
            <option value="none">–±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏</option>
            <option value="fade">fade</option>
            <option value="pop" selected>pop</option>
            <option value="slide">slide</option>
            <option value="wiggle">wiggle</option>
          </select>
        </div>
        <div class="row">
          <label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ (–º—Å)</label>
          <input id="dur" type="number" min="0" max="3000" value="550" />
        </div>
      </div>

      <div class="row">
        <label>–¢–µ–∫—Å—Ç –∑–∞–¥–∞–Ω–∏—è</label>
        <input id="task" type="text" value="–ù–∞–π–¥–∏ –±–∞–±–æ—á–∫—É –∏ –Ω–∞–∂–º–∏ –Ω–∞ –Ω–µ—ë!" />
      </div>

      <div class="two">
        <div class="row">
          <label>–û—Ç—Å—Ç—É–ø –æ—Ç –∫—Ä–∞—ë–≤ (px)</label>
          <input id="pad" type="number" min="0" max="160" value="12" />
        </div>
        <div class="row">
          <label>–ü–∞—É–∑–∞ –º–µ–∂–¥—É —Ä–∞—É–Ω–¥–∞–º–∏ (–º—Å)</label>
          <input id="gap" type="number" min="0" max="5000" value="200" />
        </div>
      </div>

      <div class="btns">
        <button class="b3" id="reset">–°–±—Ä–æ—Å</button>
        <button class="b3" id="defaultImg">–í–µ—Ä–Ω—É—Ç—å –±–∞–±–æ—á–∫—É</button>
        <button class="b1" id="getCode">–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥</button>
        <button class="b2" id="copyCode">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
      </div>

      <div class="row">
        <label>–ö–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ Genially (HTML / Embed)</label>
        <textarea id="code" class="codeBox" spellcheck="false"></textarea>
        <div class="small">
          –ï—Å–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂ –Ω–µ –≤–∏–¥–µ–Ω ‚Äî –ø—Ä–æ–≤–µ—Ä—å URL (–∫–Ω–æ–ø–∫–∞ Raw) –∏ —á—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ —Å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é (PNG/WebP/SVG).
        </div>
      </div>
    </div>

    <div class="stage" id="stage">
      <div class="topbar">
        <div class="badge" id="taskBadge">–ù–∞–π–¥–∏ –±–∞–±–æ—á–∫—É –∏ –Ω–∞–∂–º–∏ –Ω–∞ –Ω–µ—ë!</div>
        <div class="badge" id="progBadge">0/7</div>
      </div>
      <div class="previewRoot" id="previewRoot">
        <div class="target fx-pop" id="target" style="width:46px;height:46px; --dur:550ms;">
          <img id="targetImg" alt="" />
        </div>
      </div>
    </div>
  </div>

  <script>
    const $ = (id)=>document.getElementById(id);

    // ‚úÖ –í–ê–ñ–ù–û: –∑–∞–º–µ–Ω–∏ FILENAME.png –Ω–∞ —Ç–æ—á–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ (–∏ –ø—É—Ç—å, –µ—Å–ª–∏ –æ–Ω –≤ –ø–∞–ø–∫–µ)
    // –ü—Ä–∏–º–µ—Ä: ".../main/assets/babochka.png"
    const DEFAULT_URL =
      "https://raw.githubusercontent.com/propodgotovkaa-creator/babochka/main/FILENAME.png";

    const imgUrl = $("imgUrl");
    const size = $("size");
    const sizeVal = $("sizeVal");
    const rounds = $("rounds");
    const anim = $("anim");
    const dur = $("dur");
    const task = $("task");
    const pad = $("pad");
    const gap = $("gap");

    const target = $("target");
    const targetImg = $("targetImg");
    const stage = $("stage");
    const taskBadge = $("taskBadge");
    const progBadge = $("progBadge");
    const codeBox = $("code");
    const imgStatus = $("imgStatus");

    let found = 0;
    let lastPos = {x:null,y:null};

    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

    function stageRect(){
      const r = stage.getBoundingClientRect();
      return {w: Math.max(1, r.width), h: Math.max(1, r.height)};
    }

    function setTargetSize(px){
      target.style.width = px + "px";
      target.style.height = px + "px";
      sizeVal.textContent = px;
    }

    function setAnimClass(){
      target.classList.remove("fx-none","fx-fade","fx-pop","fx-slide","fx-wiggle");
      const v = anim.value;
      target.classList.add(v==="none" ? "fx-none" : ("fx-"+v));
      target.style.setProperty("--dur", Math.max(0, +dur.value || 0) + "ms");
    }

    function randomPos(){
      const {w,h} = stageRect();
      const p = clamp(+pad.value || 0, 0, 240);
      const s = parseFloat(target.style.width) || 46;

      const maxX = Math.max(p, w - p - s);
      const maxY = Math.max(p, h - p - s);

      let x, y, tries=0;
      do {
        x = p + Math.random() * (maxX - p);
        y = p + Math.random() * (maxY - p);
        tries++;
      } while (tries < 15 && lastPos.x !== null && Math.hypot(x-lastPos.x, y-lastPos.y) < s*1.4);

      lastPos = {x,y};
      return {x,y};
    }

    function placeTarget(){
      const pos = randomPos();
      target.style.left = pos.x + "px";
      target.style.top  = pos.y + "px";
    }

    function updateBadges(){
      taskBadge.textContent = task.value || "–ù–∞–π–¥–∏ –±–∞–±–æ—á–∫—É!";
      const total = Math.max(1, +rounds.value || 1);
      progBadge.textContent = `${found}/${total}`;
    }

    function resetGame(){
      found = 0;
      lastPos = {x:null,y:null};
      target.style.display = "";
      updateBadges();
      placeTarget();
      setAnimClass();
    }

    async function testImage(url){
      return new Promise((resolve)=>{
        if(!url){ resolve({ok:false, msg:""}); return; }
        const img = new Image();
        img.onload = ()=> resolve({ok:true, msg:"‚úì –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞", warn:false});
        img.onerror = ()=> resolve({ok:false, msg:"‚ö†Ô∏è –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å (–ø—Ä–æ–≤–µ—Ä—å Raw-URL)", warn:true});
        img.referrerPolicy = "no-referrer";
        img.src = url;
      });
    }

    function buildWidgetCode(cfg){
      const configJson = JSON.stringify(cfg);
      return `<div id="FX_ROOT">
  <style>
    #FX_ROOT{position:relative;width:100%;height:100%;overflow:hidden;background:transparent;}
    #FX_ROOT .fx_task{
      position:absolute;left:10px;top:10px;z-index:999999;
      background:rgba(0,0,0,.45);border:1px solid rgba(255,255,255,.18);
      padding:6px 10px;border-radius:999px;
      color:rgba(255,255,255,.92);font:600 12px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial;
      backdrop-filter:blur(6px);pointer-events:none;
      max-width:calc(100% - 120px);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    }
    #FX_ROOT .fx_prog{
      position:absolute;right:10px;top:10px;z-index:999999;
      background:rgba(0,0,0,.45);border:1px solid rgba(255,255,255,.18);
      padding:6px 10px;border-radius:999px;
      color:rgba(255,255,255,.92);font:600 12px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial;
      backdrop-filter:blur(6px);pointer-events:none;
    }
    #FX_ROOT .fx_target{
      position:absolute;z-index:999999;
      width:48px;height:48px;user-select:none;cursor:pointer;-webkit-tap-highlight-color:transparent;
    }
    #FX_ROOT .fx_target img{display:block;width:100%;height:100%;object-fit:contain}
    @keyframes fxFadeIn{from{opacity:0}to{opacity:1}}
    @keyframes fxPopIn{0%{opacity:0;transform:scale(.7)}100%{opacity:1;transform:scale(1)}}
    @keyframes fxSlideIn{0%{opacity:0;transform:translateY(-10px)}100%{opacity:1;transform:translateY(0)}}
    @keyframes fxWiggle{0%{opacity:0;transform:scale(.9) rotate(-4deg)}70%{opacity:1;transform:scale(1.02) rotate(2deg)}100%{opacity:1;transform:scale(1) rotate(0deg)}}
    #FX_ROOT .fx-none{}
    #FX_ROOT .fx-fade{animation:fxFadeIn var(--dur,500ms) ease-out}
    #FX_ROOT .fx-pop{animation:fxPopIn var(--dur,500ms) cubic-bezier(.2,.8,.2,1)}
    #FX_ROOT .fx-slide{animation:fxSlideIn var(--dur,500ms) ease-out}
    #FX_ROOT .fx-wiggle{animation:fxWiggle var(--dur,650ms) cubic-bezier(.2,.8,.2,1)}
  </style>

  <div class="fx_task"></div>
  <div class="fx_prog"></div>
  <div class="fx_target"><img alt=""></div>

  <script>
  (function(){
    const root=document.getElementById('FX_ROOT'); if(!root) return;
    const cfg=${configJson};
    const taskEl=root.querySelector('.fx_task');
    const progEl=root.querySelector('.fx_prog');
    const target=root.querySelector('.fx_target');
    const img=target.querySelector('img');

    let found=0;
    let last={x:null,y:null};

    function clamp(n,a,b){return Math.max(a,Math.min(b,n));}
    function rect(){const r=root.getBoundingClientRect();return {w:Math.max(1,r.width),h:Math.max(1,r.height)};}

    function setAnim(){
      target.classList.remove('fx-none','fx-fade','fx-pop','fx-slide','fx-wiggle');
      const v=cfg.anim||'none';
      target.classList.add(v==='none'?'fx-none':('fx-'+v));
      target.style.setProperty('--dur',Math.max(0,cfg.dur|0)+'ms');
    }

    function randomPos(){
      const {w,h}=rect();
      const s=cfg.size|0;
      const p=clamp(cfg.pad|0,0,240);
      const maxX=Math.max(p,w-p-s);
      const maxY=Math.max(p,h-p-s);
      let x,y,tries=0;
      do{
        x=p+Math.random()*(maxX-p);
        y=p+Math.random()*(maxY-p);
        tries++;
      }while(tries<15 && last.x!==null && Math.hypot(x-last.x,y-last.y)<s*1.4);
      last={x,y};
      return {x,y};
    }

    function updateUI(){
      const total=Math.max(1,cfg.rounds|0);
      taskEl.textContent=cfg.task||'–ù–∞–π–¥–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞!';
      progEl.textContent=found+'/'+total;
    }

    function place(){
      const pos=randomPos();
      target.style.left=pos.x+'px';
      target.style.top=pos.y+'px';
    }

    function next(){
      const total=Math.max(1,cfg.rounds|0);
      if(found>=total){
        taskEl.textContent=cfg.endText||'–ú–æ–ª–æ–¥–µ—Ü! –î–∞–≤–∞–π –µ—â—ë —Ä–∞–∑ üòä';
        target.style.display='none';
        return;
      }
      target.style.display='';
      setAnim();
      place();
      updateUI();
    }

    root.style.position='relative';
    root.style.background='transparent';
    img.referrerPolicy='no-referrer';
    img.src=cfg.url||'';
    target.style.width=(cfg.size|0)+'px';
    target.style.height=(cfg.size|0)+'px';

    target.addEventListener('click',()=>{
      const total=Math.max(1,cfg.rounds|0);
      if(found>=total) return;
      found++;
      updateUI();
      target.style.display='none';
      setTimeout(next,Math.max(0,cfg.gap|0));
    });

    const ro=('ResizeObserver'in window)?new ResizeObserver(()=>{if(target.style.display!=='none') place();}):null;
    if(ro) ro.observe(root);
    window.addEventListener('resize',()=>{if(target.style.display!=='none') place();},{passive:true});

    updateUI();
    next();
  })();
  <\/script>
</div>`;
    }

    function currentCfg(){
      return {
        url: (imgUrl.value || "").trim(),
        size: Math.max(18, Math.min(220, +size.value || 46)),
        rounds: Math.max(1, Math.min(99, +rounds.value || 7)),
        anim: anim.value,
        dur: Math.max(0, Math.min(3000, +dur.value || 0)),
        pad: Math.max(0, Math.min(240, +pad.value || 0)),
        gap: Math.max(0, Math.min(8000, +gap.value || 0)),
        task: (task.value || "").trim(),
        endText: "–ú–æ–ª–æ–¥–µ—Ü! –ü—Ä–∏—Ö–æ–¥–∏ –∏–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑ üòä"
      };
    }

    async function apply(){
      setTargetSize(+size.value || 46);
      setAnimClass();
      updateBadges();

      const url = (imgUrl.value || "").trim();
      targetImg.referrerPolicy = "no-referrer";
      targetImg.src = url;

      const res = await testImage(url);
      imgStatus.textContent = res.msg;
      imgStatus.className = "small " + (res.ok ? "ok" : (res.warn ? "warn" : ""));
      if(res.ok) placeTarget();
    }

    // handlers
    size.addEventListener("input", ()=>{ apply(); });
    [rounds, anim, dur, task, pad, gap, imgUrl].forEach(el=>{
      el.addEventListener("change", ()=>{ apply(); updateBadges(); });
      el.addEventListener("input", ()=>{ if(el===task) updateBadges(); });
    });

    target.addEventListener("click", ()=>{
      const total = Math.max(1, +rounds.value || 1);
      if(found >= total) return;
      found++;
      updateBadges();
      target.style.display = "none";
      setTimeout(()=>{ nextRound(); }, Math.max(0, +gap.value || 0));
    });

    function nextRound(){
      const total = Math.max(1, +rounds.value || 1);
      if(found >= total){
        taskBadge.textContent = "–ú–æ–ª–æ–¥–µ—Ü! –ü—Ä–∏—Ö–æ–¥–∏ –∏–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑ üòä";
        target.style.display = "none";
        return;
      }
      target.style.display = "";
      setAnimClass();
      placeTarget();
      updateBadges();
    }

    $("reset").addEventListener("click", resetGame);

    $("defaultImg").addEventListener("click", async ()=>{
      imgUrl.value = DEFAULT_URL;
      await apply();
      resetGame();
    });

    $("getCode").addEventListener("click", ()=>{
      const cfg = currentCfg();
      codeBox.value = buildWidgetCode(cfg);
      codeBox.focus();
      codeBox.select();
    });

    $("copyCode").addEventListener("click", async ()=>{
      if(!codeBox.value.trim()){
        const cfg = currentCfg();
        codeBox.value = buildWidgetCode(cfg);
      }
      try{
        await navigator.clipboard.writeText(codeBox.value);
        imgStatus.textContent = "‚úì –∫–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω";
        imgStatus.className = "small ok";
      }catch(e){
        codeBox.focus(); codeBox.select();
        imgStatus.textContent = "‚ö†Ô∏è –Ω–µ —Å–º–æ–≥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî –≤—ã–¥–µ–ª–∏–ª–∞ –∫–æ–¥, –Ω–∞–∂–º–∏ Cmd+C";
        imgStatus.className = "small warn";
      }
    });

    // ‚úÖ INIT: –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —Å—Ä–∞–∑—É —Å—Ç–∞–≤–∏–º –±–∞–±–æ—á–∫—É
    imgUrl.value = DEFAULT_URL;
    apply().then(resetGame);

  </script>
</body>
</html>
